<!DOCTYPE html>
<html lang="zh-CN" data-use-rem="">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"/>
    <meta name="description" content="description"/>
    <meta name="keywords" content="a,b"/>
    <title>活动签到</title>
    <link rel="stylesheet" href="../css/style.css"/>
  </head>
  <body ontouchstart="">
    <div class="p-wrap">
      <div class="loading-wrap"></div>
      <div class="check-act">
        <div class="map-head">爱芬环保</div>
        <div class="map-location">南山深南大道10000</div>
        <div class="map-wrap">
          <div id="normal_map" class="normal_map"></div>
        </div>
        <div class="check-btn">验证地点中...</div>
        <div class="map-distance">距离目的地还有<span id="map_distance">?</span>米</div>
      </div>
    </div>
    <script src="../js/zepto.js"></script>
    <script src="../js/zepto-touch.js"></script>
    <script src="../js/grid.js"></script>
    <script>
      $('.check-act').addClass("show");
      $('.loading-wrap').addClass("loaded");
    </script>
    <script src="http://api.map.baidu.com/api?v=2.0&amp;ak=bqrBwGSqxQ6HULhXQdUXh8aq"></script>
    <script>
      //地图展示
      var i_l = 113.361203,
          i_r = 23.162477,
          t_l = 0,
          t_r = 0;
      
      var check_btn = $(".check-btn");
      
      $.get('../js/activity-json.json',function(data){
          t_l = Number(data.signPosition.lat);
          t_r = Number(data.signPosition.lon);
          
          var disX = Math.abs(i_l - t_l)*10000;
          var disY = Math.abs(i_r - t_r)*10000;
          
          var distance = Math.floor(disX*disX+ disY*disY);
          $("#map_distance").html(distance);
          if( distance < 500){
              check_btn.html("点击签到");
              check_btn.addClass("allow");
          }else{
              check_btn.html("请进入目的地500米内签到")
          }
      
          var initPlace = new BMap.Point(i_l,i_r);
          var targetPlace = new BMap.Point(t_l,t_r);
      
          var mapOption = {
              mapType: BMAP_NORMAL_MAP,
              maxZoom: 18,
              drawMargin:0,
              enableFulltimeSpotClick: true,
              enableHighResolution:true
          }
          var map = new BMap.Map("normal_map", mapOption);
          map.centerAndZoom(initPlace, 18);
      
          var marker=new BMap.Marker(initPlace);
          map.addOverlay(marker);  
      
          var tmpMarker=new BMap.Marker(targetPlace);
          var tmpIcon = new BMap.Icon("../img/map-target.png", new BMap.Size(20,20));
          tmpMarker.setIcon(tmpIcon);
          map.addOverlay(tmpMarker);
      
      
      
      });
    </script>
  </body>
</html>